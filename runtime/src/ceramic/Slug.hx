package ceramic;

// Haxe port of https://github.com/simov/slugify
// Imported from https://lib.haxe.org/p/slug

using StringTools;

class Slug {

    public static final RE_SLUG_REMOVE_CHARS = ~/[$*+~.()'"!\\:@\?ยง]/g;

	public static final DEFAULT_OPTIONS:SlugOptions = {};

	public static var charMap:Map<Int, String> = [
		36 => "dollar", 37 => "percent", 38 => "and", 60 => "less", 62 => "greater", 124 => "or", 162 => "cent", 163 => "pound", 164 => "currency",
		165 => "yen", 169 => "(c)", 170 => "a", 174 => "(r)", 186 => "o", 192 => "A", 193 => "A", 194 => "A", 195 => "A", 196 => "A", 197 => "A", 198 => "AE",
		199 => "C", 200 => "E", 201 => "E", 202 => "E", 203 => "E", 204 => "I", 205 => "I", 206 => "I", 207 => "I", 208 => "D", 209 => "N", 210 => "O",
		211 => "O", 212 => "O", 213 => "O", 214 => "O", 216 => "O", 217 => "U", 218 => "U", 219 => "U", 220 => "U", 221 => "Y", 222 => "TH", 223 => "ss",
		224 => "a", 225 => "a", 226 => "a", 227 => "a", 228 => "a", 229 => "a", 230 => "ae", 231 => "c", 232 => "e", 233 => "e", 234 => "e", 235 => "e",
		236 => "i", 237 => "i", 238 => "i", 239 => "i", 240 => "d", 241 => "n", 242 => "o", 243 => "o", 244 => "o", 245 => "o", 246 => "o", 248 => "o",
		249 => "u", 250 => "u", 251 => "u", 252 => "u", 253 => "y", 254 => "th", 255 => "y", 256 => "A", 257 => "a", 258 => "A", 259 => "a", 260 => "A",
		261 => "a", 262 => "C", 263 => "c", 268 => "C", 269 => "c", 270 => "D", 271 => "d", 272 => "DJ", 273 => "dj", 274 => "E", 275 => "e", 278 => "E",
		279 => "e", 280 => "e", 281 => "e", 282 => "E", 283 => "e", 286 => "G", 287 => "g", 290 => "G", 291 => "g", 296 => "I", 297 => "i", 298 => "i",
		299 => "i", 302 => "I", 303 => "i", 304 => "I", 305 => "i", 310 => "k", 311 => "k", 315 => "L", 316 => "l", 317 => "L", 318 => "l", 321 => "L",
		322 => "l", 323 => "N", 324 => "n", 325 => "N", 326 => "n", 327 => "N", 328 => "n", 336 => "O", 337 => "o", 338 => "OE", 339 => "oe", 340 => "R",
		341 => "r", 344 => "R", 345 => "r", 346 => "S", 347 => "s", 350 => "S", 351 => "s", 352 => "S", 353 => "s", 354 => "T", 355 => "t", 356 => "T",
		357 => "t", 360 => "U", 361 => "u", 362 => "u", 363 => "u", 366 => "U", 367 => "u", 368 => "U", 369 => "u", 370 => "U", 371 => "u", 377 => "Z",
		378 => "z", 379 => "Z", 380 => "z", 381 => "Z", 382 => "z", 402 => "f", 416 => "O", 417 => "o", 431 => "U", 432 => "u", 456 => "LJ", 457 => "lj",
		459 => "NJ", 460 => "nj", 536 => "S", 537 => "s", 538 => "T", 539 => "t", 730 => "o", 902 => "A", 904 => "E", 905 => "H", 906 => "I", 908 => "O",
		910 => "Y", 911 => "W", 912 => "i", 913 => "A", 914 => "B", 915 => "G", 916 => "D", 917 => "E", 918 => "Z", 919 => "H", 920 => "8", 921 => "I",
		922 => "K", 923 => "L", 924 => "M", 925 => "N", 926 => "3", 927 => "O", 928 => "P", 929 => "R", 931 => "S", 932 => "T", 933 => "Y", 934 => "F",
		935 => "X", 936 => "PS", 937 => "W", 938 => "I", 939 => "Y", 940 => "a", 941 => "e", 942 => "h", 943 => "i", 944 => "y", 945 => "a", 946 => "b",
		947 => "g", 948 => "d", 949 => "e", 950 => "z", 951 => "h", 952 => "8", 953 => "i", 954 => "k", 955 => "l", 956 => "m", 957 => "n", 958 => "3",
		959 => "o", 960 => "p", 961 => "r", 962 => "s", 963 => "s", 964 => "t", 965 => "y", 966 => "f", 967 => "x", 968 => "ps", 969 => "w", 970 => "i",
		971 => "y", 972 => "o", 973 => "y", 974 => "w", 1025 => "Yo", 1026 => "DJ", 1028 => "Ye", 1030 => "I", 1031 => "Yi", 1032 => "J", 1033 => "LJ",
		1034 => "NJ", 1035 => "C", 1039 => "DZ", 1040 => "A", 1041 => "B", 1042 => "V", 1043 => "G", 1044 => "D", 1045 => "E", 1046 => "Zh", 1047 => "Z",
		1048 => "I", 1049 => "J", 1050 => "K", 1051 => "L", 1052 => "M", 1053 => "N", 1054 => "O", 1055 => "P", 1056 => "R", 1057 => "S", 1058 => "T",
		1059 => "U", 1060 => "F", 1061 => "H", 1062 => "C", 1063 => "Ch", 1064 => "Sh", 1065 => "Sh", 1066 => "U", 1067 => "Y", 1068 => "", 1069 => "E",
		1070 => "Yu", 1071 => "Ya", 1072 => "a", 1073 => "b", 1074 => "v", 1075 => "g", 1076 => "d", 1077 => "e", 1078 => "zh", 1079 => "z", 1080 => "i",
		1081 => "j", 1082 => "k", 1083 => "l", 1084 => "m", 1085 => "n", 1086 => "o", 1087 => "p", 1088 => "r", 1089 => "s", 1090 => "t", 1091 => "u",
		1092 => "f", 1093 => "h", 1094 => "c", 1095 => "ch", 1096 => "sh", 1097 => "sh", 1098 => "u", 1099 => "y", 1100 => "", 1101 => "e", 1102 => "yu",
		1103 => "ya", 1105 => "yo", 1106 => "dj", 1108 => "ye", 1110 => "i", 1111 => "yi", 1112 => "j", 1113 => "lj", 1114 => "nj", 1115 => "c", 1119 => "dz",
		1168 => "G", 1169 => "g", 3647 => "baht", 4304 => "a", 4305 => "b", 4306 => "g", 4307 => "d", 4308 => "e", 4309 => "v", 4310 => "z", 4311 => "t",
		4312 => "i", 4313 => "k", 4314 => "l", 4315 => "m", 4316 => "n", 4317 => "o", 4318 => "p", 4319 => "zh", 4320 => "r", 4321 => "s", 4322 => "t",
		4323 => "u", 4324 => "f", 4325 => "k", 4326 => "gh", 4327 => "q", 4328 => "sh", 4329 => "ch", 4330 => "ts", 4331 => "dz", 4332 => "ts", 4333 => "ch",
		4334 => "kh", 4335 => "j", 4336 => "h", 7838 => "SS", 7840 => "A", 7841 => "a", 7842 => "A", 7843 => "a", 7844 => "A", 7845 => "a", 7846 => "A",
		7847 => "a", 7848 => "A", 7849 => "a", 7850 => "A", 7851 => "a", 7852 => "A", 7853 => "a", 7854 => "A", 7855 => "a", 7856 => "A", 7857 => "a",
		7858 => "A", 7859 => "a", 7860 => "A", 7861 => "a", 7862 => "A", 7863 => "a", 7864 => "E", 7865 => "e", 7866 => "E", 7867 => "e", 7868 => "E",
		7869 => "e", 7870 => "E", 7871 => "e", 7872 => "E", 7873 => "e", 7874 => "E", 7875 => "e", 7876 => "E", 7877 => "e", 7878 => "E", 7879 => "e",
		7880 => "I", 7881 => "i", 7882 => "I", 7883 => "i", 7884 => "O", 7885 => "o", 7886 => "O", 7887 => "o", 7888 => "O", 7889 => "o", 7890 => "O",
		7891 => "o", 7892 => "O", 7893 => "o", 7894 => "O", 7895 => "o", 7896 => "O", 7897 => "o", 7898 => "O", 7899 => "o", 7900 => "O", 7901 => "o",
		7902 => "O", 7903 => "o", 7904 => "O", 7905 => "o", 7906 => "O", 7907 => "o", 7908 => "U", 7909 => "u", 7910 => "U", 7911 => "u", 7912 => "U",
		7913 => "u", 7914 => "U", 7915 => "u", 7916 => "U", 7917 => "u", 7918 => "U", 7919 => "u", 7920 => "U", 7921 => "u", 7922 => "Y", 7923 => "y",
		7924 => "Y", 7925 => "y", 7926 => "Y", 7927 => "y", 7928 => "Y", 7929 => "y", 8216 => "'", 8217 => "'", 8220 => "\"", 8221 => "\"", 8224 => "+",
		8226 => "*", 8230 => "...", 8352 => "ecu", 8354 => "cruzeiro", 8355 => "french franc", 8356 => "lira", 8357 => "mill", 8358 => "naira",
		8359 => "peseta", 8360 => "rupee", 8361 => "won", 8362 => "new shequel", 8363 => "dong", 8364 => "euro", 8365 => "kip", 8366 => "tugrik",
		8367 => "drachma", 8368 => "penny", 8369 => "peso", 8370 => "guarani", 8371 => "austral", 8372 => "hryvnia", 8373 => "cedi", 8377 => "indian rupee",
		8381 => "russian ruble", 8383 => "bitcoin", 8480 => "sm", 8482 => "tm", 8706 => "d", 8710 => "delta", 8721 => "sum", 8734 => "infinity",
		9829 => "love", 20803 => "yuan", 20870 => "yen", 65020 => "rial",
	];

	public static final safe:EReg = ~/[^\w\s$*_+~.()'"!\-:@]/g;

	public static function encode(str:String, ?options:SlugOptions):String {
		if (options == null)
			options = DEFAULT_OPTIONS;
		var buf = new StringBuf();
		for (c in new haxe.iterators.StringIteratorUnicode(str))
			buf.add(charMap.exists(c) ? charMap[c] : String.fromCharCode(c));
		var ret = buf.toString().trim();
		ret = (options.remove != null ? options.remove : safe).map(ret, _ -> "");
		ret = ret.replace(" ", options.replacement);
		if (options.lower)
			return ret.toLowerCase();
		return ret;
	}
}

@:structInit class SlugOptions {
	public final lower:Bool = true;
	public final remove:EReg = Slug.RE_SLUG_REMOVE_CHARS;
	public final replacement:String = "-";
}
